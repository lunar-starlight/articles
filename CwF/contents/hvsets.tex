\section{Heyting-valued Sets}

\def\h{\mathcal{H}}

\subsection{Preliminaries}

\begin{definition}
  A \emph{Heyting-valued set \(A\)} is a carrier set \(\abs A\) equipped with a
  ``Heyting-valued relation'' \(\eq[A]{-}{-} : AÃ—A â†’ \h\) satisfying
  \begin{gather}
    \label{hvs:symm}  \eq x y â‰¤ \eq y x\\
    \label{hvs:trans} \eq x y âˆ§ \eq y z â‰¤ \eq x z
  \end{gather}

  Define \(\e x â‰” \eq x x\).
\end{definition}

\begin{definition}
  A \emph{Heyting-valued morphism \(f : A â†¬ B\)} is a ``Heyting-valued,b
  functional relation'', meaning it is a map \(\abs f : \abs A Ã— \abs B â†’ \h\)
  satisfying
  \begin{gather}
    \label{hvm:str}    f(x,y) â‰¤ \e x âˆ§ \e y\\
    \label{hvm:well}   \eq {x'} x âˆ§ f(x, y) âˆ§ \eq y {y'} â‰¤ f(x', y')\\
    \label{hvm:unique} f(x, y) âˆ§ f(x, y') â‰¤ \eq y {y'}\\
    \label{hvm:total}  \e x â‰¤ â‹_{y âˆˆ B}f(x, y)
  \end{gather}
\end{definition}

\begin{fact}
  The following hold.
  
  \begin{enumerate}
  \item \(f(x,y)âˆ§\eq x {x'} = f(x',y)âˆ§\eq x {x'}\)
  \item \(\e x = â‹_{yâˆˆA}\eq x y\)
  \end{enumerate}
\end{fact}


\begin{construction}
  The product \(AÃ—B\) is given by \(\abs A Ã— \abs B\) with equality
  \[ \eq{\p{x,y}}{\p{x',y'}} â‰” \eq x {x'} âˆ§ \eq y {y'}\text. \]

  The projection \(Ï€ : AÃ—B â†¬ A\) is defined by
  \[ \p{\p{x,y}, x'} â†¦ \eq x {x'} âˆ§ \e y\text. \]
  The other projection is defined similarly
\end{construction}
\begin{proof}
  Symmetry and transitivity of the equality follow clearly.

  Likewise, the projection is clearly strict and well-defined.
  Uniqueness holds via
  \begin{align*}
    Ï€(\p{x,y},x') âˆ§ Ï€(\p{x,y},x'')
    &= \eq x {x'} âˆ§ \e y âˆ§ \eq x {x''} âˆ§ \e y\\
    &= \eq x {x'} âˆ§ \eq x {x''} âˆ§ \e y\\
    &â‰¤ \eq {x'} {x''} âˆ§ \e y\\
    &â‰¤ \eq {x'} {x''}\text.
  \end{align*}
  Totality holds via
  \begin{align*}
    \e{\p{x,y}} = \e x âˆ§ \e y = â‹_{x'âˆˆA}\eq x {x'} âˆ§ \e y\text.
  \end{align*}
\end{proof}

In the following, I will not write out these proofs. A standard reference is
TODO BorceuxV3.

\begin{construction}
  The \emph{discrete Heyting-valued set \(Î”A\) on \(A\)} has \(A\) as it's
  carrier and equality defined by \(\p{x,y} â†¦ â‹\set{âŠ¤}{x=y}\).
\end{construction}

\begin{fact}
  The empty type \(âˆ…\) is given by the empty carrier.

  The unit type \(\mb 1\) is given by \(\{\ast\}\) with \(\e\ast = âŠ¤\). This is
  the discrete Heyting-valued set on \(\{\ast\}\).

  The natural numbers object is the discrete Heyting-valued set on \(â„•\).

  The rational numbers object is the discrete Heyting-valued set on \(â„š\).
\end{fact}
\begin{note}
  The real numbers object is not necessarily discrete.
\end{note}

\begin{construction}
  The sum \(A+B\) is given by \(\abs A+\abs B\) with equality defined by
  \begin{align*}
    &\eq {\inl x} {\inl x'} â‰” \eq[A] x {x'}\\
    &\eq {\inl x} {\inr y'} â‰” âŠ¥\\
    &\eq {\inr y} {\inr x'} â‰” âŠ¥\\
    &\eq {\inr y} {\inr y'} â‰” \eq[B] y {y'}
  \end{align*}

  The inclusion \(Î¹ : A â†¬ A+B\) is given by \(\p{x,t} â†¦ \eq {\inl x} t\).
  The other inclusion is defined similarly.
\end{construction}

\begin{construction}
  The subobject classifier \(Î©\) is given by \(\h\) with \(âˆ§\) as equality.
\end{construction}

\begin{construction}
  The exponent \(B^A\) is given by
  \[ \set{f : \abs A Ã— \abs B â†’ \h}{\ref{hvm:str}-\ref{hvm:unique}} \]
  with equality
  \[ \p{f,g} â†¦ â‹€_{xâˆˆA}â‹_{yâˆˆB}f(x,y) âˆ§ g(x,y)\text. \]
\end{construction}

\begin{fact}
  The powerobject \(ğ’«A = Î©^A\) can be given as the discrete Heyting-valued set
  on \(\set{P : \abs A â†’ Î©}{\eq {x'} x âˆ§ P(x) â‰¤ P(x')}\).
\end{fact}

\begin{construction}
  The restriction \(A\res p\) is given by \(\set{x âˆˆ A}{\e x \between p}\)
\end{construction}


\subsection{CwF structure}

To define what is a family we first define a ``universe''.

\begin{construction}
  Up to size issues the class of all Heyting-valued sets \(\hvsets\) with
  equality \(\p{A,B} â†¦ â‹\set{pâˆˆ\h}{A\res p = B\res p}\) is a Heyting-valued set.
\end{construction}

\begin{construction}
  Given a  family \(\p{Bâ‚}_{aâˆˆA}\) of Heyting-valued sets, such that
  \(Bâ‚\res{\eq a {a'}} = B_{a'}\res{\eq a {a'}}\), the gluing \(â‹B\) has carrier
  \[ \set{b âˆˆ Bâ‚\res{\e a}}{a âˆˆ A} = â‹ƒ_{a âˆˆ A}Bâ‚\res{\e a} \] and equality
  %\[ \p{b, b'} â†¦ â‹_{a,a' âˆˆ A} b âˆˆ Bâ‚\res {\eq a {a'}} âˆ§ b' âˆˆ B_{a'}\res{\eq a {a'}}
  %  âˆ§ \eq a {a'} âˆ§ \eq[Bâ‚\res {\eq a {a'}}] b {b'}\text. \]
  \[ \p{b, b'} â†¦ â‹_{a âˆˆ A} b,b' âˆˆ Bâ‚\res {\e a} âˆ§ \eq[Bâ‚\res {\e a}] b {b'}\text. \]
\end{construction}
\begin{proof}
  Let \(bâ‚€, bâ‚, bâ‚‚ âˆˆ â‹B\). Then by construction \(báµ¢ âˆˆ B_{aáµ¢}\res{\e {aáµ¢}}\) for
  some \(aáµ¢ âˆˆ A\).
  \begin{align*}
    \eq {bâ‚€} {bâ‚}
    = â‹_{a âˆˆ A} bâ‚€,bâ‚ âˆˆ Bâ‚\res {\e a} âˆ§ \e a âˆ§ \eq[Bâ‚\res {\e a}] {bâ‚€} {bâ‚}\\
    â‰¤ â‹_{a âˆˆ A} bâ‚,bâ‚€ âˆˆ Bâ‚\res {\e a} âˆ§ \e a âˆ§ \eq[Bâ‚\res {\e a}] {bâ‚} {bâ‚€}\\
    &= \eq {bâ‚} {bâ‚€}
  \end{align*}
  \begin{align*}
    \eq {bâ‚€} {bâ‚} âˆ§ \eq {bâ‚} {bâ‚‚}
    = â‹_{a,a' âˆˆ A} bâ‚€,bâ‚ âˆˆ Bâ‚\res {\e a} âˆ§ \e a âˆ§ \eq[Bâ‚\res {\e a}] {bâ‚€} {bâ‚}
    âˆ§ bâ‚,bâ‚‚ âˆˆ B_{a'}\res {\e {a'}} âˆ§ \e {a'} âˆ§ \eq[B_{a'}\res {\e {a'}}] {bâ‚} {bâ‚‚}\\
    &= â‹_{a âˆˆ A} bâ‚€,bâ‚,bâ‚‚ âˆˆ Bâ‚\res {\e a} âˆ§ \e a
    âˆ§ \eq[Bâ‚\res {\e a}] {bâ‚€} {bâ‚} âˆ§ \eq[Bâ‚\res {\e a}] {bâ‚} {bâ‚‚}\\
    &â‰¤ â‹_{a âˆˆ A} bâ‚€,bâ‚‚ âˆˆ Bâ‚\res {\e a} âˆ§ \e a
    âˆ§ \eq[Bâ‚\res {\e a}] {bâ‚€} {bâ‚‚}\\
    &= \eq {bâ‚€} {bâ‚‚}
  \end{align*}
\end{proof}

\begin{theorem}
  Morphisms \(f : A â†¬ ğ’°\) correspond precisely to maps \(\hat f : A â†’ ğ’°\)
  satisfying \(\hat f(x)\res{\eq x {x'}} = \hat f(x')\res{\eq x {x'}}\).
\end{theorem}
\begin{proof}
  Take \(a âˆˆ A\). The carrier of \(\hat f(a)\) is the set
  \(\set{x âˆˆ X}{X âˆˆ ğ’° âˆ§ \e x \between f(a, X)}\) with equality
  \(\p{x,y} â†¦ â‹_{Xâˆ‹x,\\Yâˆ‹y}f(a, X) âˆ§ f(a, Y) âˆ§ \eq[X\res{\eq X Y}] x y\).

  Take another \(a' âˆˆ A\). The restriction \(\hat f(a)\res{\eq a {a'}}\) has as
  carrier
  \[ \set{x âˆˆ X}{X âˆˆ ğ’° âˆ§ \e x âˆ§ f(a,x) \between \eq a {a'}}\text. \]
  The condition \(\e x âˆ§ f(a, X) \between \eq a {a'}\) is equivalent to
  \[ âŠ¥ < \e x âˆ§ f(a, X) âˆ§ \eq a {a'} \text, \]
  so it is also equivalent to \(\e x âˆ§ f(a', X) \between \eq a {a'}\).

  Thus, \(\hat f(a)\res{\eq a {a'}} = \hat f(a')\res{\eq a {a'}}\).

  In the other direction taking a map \(\hat f : A â†’ ğ’°\) we define
  \(f(a, X) â‰” \e a âˆ§ \eq X {\hat f(a)}\).
\end{proof}
















\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../main"
%%% End:
